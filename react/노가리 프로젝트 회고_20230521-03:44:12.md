
![](https://raw.githubusercontent.com/appletail/study/main/react/imgs/%EB%85%B8%EA%B0%80%EB%A6%AC%20%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%20%ED%9A%8C%EA%B3%A0_20230521-03%3A44%3A12_1.png)


# Notion 2 Blog 노션에서 블로그로 
원클릭 발행서비스 [노가리](https://www.nogari.me/)


## 시작 이유


이번 자율프로젝트는 저희 팀원들이 함께 협업하면서 실제 프로젝트를 경험하고자 시작하게 되었습니다. 이번 프로젝트는 우리가 배운 것을 바탕으로 실제 현업에서 사용될 만한 프로젝트를 진행하는 것이 목표였습니다.


노션에서 블로그로 가는 서비스를 기획했던 이유는 우리가 필요로 하는 서비스라는 것입니다. 평소 공부한 것을 노션에 기록하는데 이를 다시 티스토리로 옮기는 것이 힘들었습니다. N2T라는 프로그램을 쓴다고 해도 사용법이 어렵고, 맥을 기준으로 만든 것이라서 설정이 힘들었습니다. 저뿐만 아니라 다른 사람들도 비슷한 어려움이 있을 것이라 생각을 하여 프로젝트를 기획하게 되었습니다.


## 프로젝트 내용


프로젝트 내용은 노션 api와 티스토리api 그리고 깃허브 api를 이용하여 각 플랫폼을 연결시키는 것입니다. 노션에서 글작성 후 페이지url을 사이트에 넣고 발행하기를 누르면 자동으로 티스토리에 게시가 됩니다. 


이번 프로젝트에서 우리는 react를 사용하여 프론트를 구성하였으며 spring으로 백엔드를 구성하였습니다. 노션 게시글은 notion-to-md 라이브러리를 사용했지만 많은 부분을 커스터마이징하여 구현하였으며 aws lambda에 올려 사용했습니다. 또한 사용자의 접근 편의성을 높이기 위해 [크롬 확장프로그램](https://chrome.google.com/webstore/detail/nogari-%EB%85%B8%EC%85%98%EC%97%90%EC%84%9C-%EA%B0%80%EB%8A%94-%EC%9D%B4%EC%95%BC%EA%B8%B0/hjdmhaniikfbncdhikfbgfkpchicegfp?hl=ko&authuser=1)을 만들어서 크롬 웹 스토어에 배포하였습니다.


## 담당역할


### 1. 프론트엔드 개발 환경 구축 및 개발

- 가벼운 개발환경을 만들기 위해 vite를 사용하였습니다. react와 typescript로 구성하였으며 mvc패턴이 되도록 노력하였습니다.
- eslint, prettier로 컨벤션을 지킬 수 있도록 하였으며 postcss로 module.css 등을 적용할 수 있도록 하였습니다.
- 사이드바 구현
	- mui 템플릿을 바탕으로 타입스크립트로 변환하여 우리 프로젝트에 맞게 변환했습니다.
- 튜토리얼 화면 구현
	- 사용법이 직관적이지 않다는 피드백을 받아서 첫 로그인시 튜토리얼 화면이 나오도록 구현했습니다.

		**구현 코드**


		![](https://raw.githubusercontent.com/appletail/study/main/react/imgs/%EB%85%B8%EA%B0%80%EB%A6%AC%20%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%20%ED%9A%8C%EA%B3%A0_20230521-03%3A44%3A12_2.png)


		기본값을 false로 하여 튜토리얼이 안나오도록하였으며, 로컬 스토리지를 확인해 튜토리얼을 본적이 없다면 튜토리얼 화면이 나오도록 했습니다.


		![](https://raw.githubusercontent.com/appletail/study/main/react/imgs/%EB%85%B8%EA%B0%80%EB%A6%AC%20%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%20%ED%9A%8C%EA%B3%A0_20230521-03%3A44%3A12_3.png)


		튜토리얼은 컴포넌트화해서 만들었으며 클릭시마다 다음이미지가 나오도록했습니다. 그리고 마지막 이미지가 나올 시 props받은 setTutorial에 false를 넣어 컴포넌트가 unmount되도록 했습니다.


		**아쉬운 점**


		발표날이 얼마 안남은 상태에서 구현했기 때문에 하드 코딩한 것이 아쉬웠습니다. 추후 확장성과 가독성이 높아지도록 리팩토링할 것입니다.

- 테이블 행 추가 후 특정 상황에 행이 사라지는 버그

	**해결과정**

	1. 버그 원인 분석
		- 행과 관련하여 버그가 발생하는 것으로 보여 행과 관련한 코드 전부에 console.log 찍어봄
		- 그 결과 행이 사라질 때마다 react query의 fetch가 일어나는 것을 확인함
		- fetch가 일어나면서 행을 초기화된 것으로 판단함
	2. 문제 해결
		- fetch가 일어난 것이 직접적인 원인이므로 react query의 useQuery가 언제 fetch하는지 알아봄
			- 새로운 query 인스턴스가 마운트될 때 (useQuery가 처음 호출될 때)
			- **브라우저 화면을 이탈했다가 다시 포커스할 때**
			- 네트워크가 다시 연결될 때
			- 특별히 설정한 refetch interval에 의해서 (refetchInterval)

			브라우저 화면을 이탈했다가 다시 포커스될 때 fetch된다는 것을 알게되어 refetchOnWindowFocus: false를 추가해서 버그를 해결함


			![](https://raw.githubusercontent.com/appletail/study/main/react/imgs/%EB%85%B8%EA%B0%80%EB%A6%AC%20%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%20%ED%9A%8C%EA%B3%A0_20230521-03%3A44%3A12_4.png)

- 테이블 발행상태 항목 유지가 안되는 버그

	**해결과정**

	1. 버그 원인 분석
		- 로그 상 발행상태에 따라 발행상태 항목이 유지되어야하는데 , 현재 선택된 항목에 따라 항목이 달라지는 것을 확인함
	2. 문제 해결
		- 로그 상 발행상태를 기억할 필요가 있어서 안보이는 column을 하나 만듦

		![](https://raw.githubusercontent.com/appletail/study/main/react/imgs/%EB%85%B8%EA%B0%80%EB%A6%AC%20%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%20%ED%9A%8C%EA%B3%A0_20230521-03%3A44%3A12_5.png)

		- 만들어진 column을 바탕으로 항목이 변화하도록 변경

		![](https://raw.githubusercontent.com/appletail/study/main/react/imgs/%EB%85%B8%EA%B0%80%EB%A6%AC%20%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%20%ED%9A%8C%EA%B3%A0_20230521-03%3A44%3A12_6.png)


### 2. notion Parser 개발 환경 구축 및 개발

- vite를 사용하였으며, typescript환경에서 개발하였습니다. 또한 [notion-to-md](https://github.com/souvikinator/notion-to-md)와 [markdown-it](https://github.com/markdown-it/markdown-it) 라이브러리르 활용했습니다.
- spring과 typescript로 만들어진 함수를 자바에서 호출하기 위해 build하여 aws lambda에 올렸습니다. 그리고 lambda function url로 호출하였습니다.
- 자바가 아닌 typescript로 구현한 이유는 짧은 개발 기간동안 notion게시글을 md와 html로 바꾸기 위해서는 라이브러리 사용이 불가피하다고 생각했습니다. 그런데 typescript와 달리 java에서는 관련 라이브러리가 없었기 때문에 typescript로 구현하였습니다.’

### 3. [크롬 확장프로그램](https://chrome.google.com/webstore/detail/nogari-%EB%85%B8%EC%85%98%EC%97%90%EC%84%9C-%EA%B0%80%EB%8A%94-%EC%9D%B4%EC%95%BC%EA%B8%B0/hjdmhaniikfbncdhikfbgfkpchicegfp?hl=ko&authuser=1) 개발 환경 구축 및 개발

- [crx](https://crxjs.dev/vite-plugin/)를 사용하였으며, react와 typescript, manifest version 3으로 만들었습니다. version 2는 곧 지원이 끝난다고하여 지원이 잘 되고있는 version  3으로 만들었습니다.
- api는 기존의 web 서비스와 같은 api를 활용했으며, 설정의 경우 chrome.storage.sync에 저장하여 어디서든 같은 설정을 공유할 수 있도록하였습니다.
- 크롬 웹스토어에 배포까지 완료했습니다.

## 성과


이번 프로젝트의 가장 큰 성과는 우리 서비스 그 자체가 아닐까 생각합니다. 이 글 또한 노션에서 작성한 것이고 우리 서비스를 이용해 티스토리로 옮긴 것인데 스스로도 상당히 만족도가 높았기 때문입니다. 만약 평소에 노션으로 공부한 것을 정리하고 있지만 따로 블로그를 운영하지 않고 있는 사람이 있다면 우리 서비스를 활용해 블로그 하나 만드는데 오래걸리지 않을 것입니다.


개인적인 성과로는 aws lambda를 적용해 본것이라고 생각합니다. FaaS의 유용성에 대해 이론적으로만 알고 있었는데, 실제로 사용해보니 다양하게 활용이 가능할 것으로 생각됩니다. 우리 서비스를 이용한 만큼 비용을 지불한다는 점도 좋았지만, 우리 프로젝트에서 적용한 이유처럼 개발 과정에서 각 기능이 언어가 달라도 어렵지 않게 적용이 가능하다는 점이 좋았습니다.


이와 유사한 방법 중 하나로 MSA가 있지만 실제로 적용을 시도했을 때 상당히 복잡했고, 우리 서비스에 굳이 필요할까라는 생각이 들어 포기했었습니다. 하지만 aws lambda를 사용하니 msa와 유사하게 작동하면서도 적용이 쉬워 만족스러운 경험이었습니다.


크롬 확장프로그램을 배포한 것 또한 좋은 성과였습니다. 크롬 확장프로그램을 만들게 된 이유는 매번 우리 웹사이트로 접속해서 주소를 복사해서 넣고 발행버튼을 누르는 과정이 번거롭다는 이유 때문이었습니다. 사용자가 조금이라도 편하게 사용할 방법이 무엇이 있을까 생각한 결과 크롬 확장프로그램 배포를 생각하게 되었습니다. 실제로 사용자들의 평도 편하다는 평가가 있어 좋았습니다.


## 어려움


하지만, 이번 프로젝트를 수행하면서도 어려움이 존재했습니다. 그 중에서도 notion게시글을 html로 바꾸는 것이 어려웠습니다. 처음에 레퍼런스로 삼았던 [N2T](https://github.com/jmjeon94/N2T)의 경우 개발자도구를 열어 notion에서 보내는 쿠키 중 token_v2를 가져와야했기 때문에 사용자 경험이 최악일 것으로 보였습니다. 그렇기 때문에 notion integration을 사용한 라이브러리를 찾아야했습니다. 


notion에서 바로 html로 바꾸는 라이브러리는 없었기 때문에 중간 단계를 거치는 방법을 생각했습니다. 그 결과 notion에서 md로 다시 md에서 html로 바꾸는 방법을 생각해내게 되었습니다. md를 중간단계로 거친 이유는 [화해 블로그](https://blog.hwahae.co.kr/all/tech/10960)에서 인사이트를 얻어 사용하게되었습니다. md는 다른 형태로 변환하기 쉽다고 하여 확장성이 좋다고 생각하였고, 또한 깃허브에 올리기 위해서는 md 파일이 좋다고 판단하여 선택하게 되었습니다. 그 결과 notion-to-md와 markdown-it을 각각 notion ⇒ md / md ⇒ html 변환하는 라이브러리로 선택하게 되었습니다.


하지만 notion-to-md는 글자색과 같 notion의 형식을 유지하지 못한다는 문제점이 있었습니다. 그래서 setCustomTransformer 메서드를 이용해 각 notion block type 별로 수정을 했습니다.


![](https://raw.githubusercontent.com/appletail/study/main/react/imgs/%EB%85%B8%EA%B0%80%EB%A6%AC%20%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%20%ED%9A%8C%EA%B3%A0_20230521-03%3A44%3A12_7.png)


코드가 잘 작동하는 것을 확인했지만 메서드를 사용하는 만큼 코드 구성에 제약이 많았습니다. 추후에는 라이브러리 원본 코드를 직접 수정하여 적용하는 방식으로 개선할 예정입니다.


## 교훈


이번 프로젝트를 수행하면서 얻은 교훈은 명확한 목표의식이 중요하다는 것입니다. 이번 프로젝트는 팀원이 모인 후 기획을 시작한 것이 아닌 목표를 먼저 정한 후 팀원이 모였습니다. 그 덕분에 각자 해야할 일을 명확히 이해할 수 있었고, 이전 프로젝트들 보다 빠르게 개발을 할 수 있었습니다.


기업에는 미션과 비전이 있습니다. 이번 경험은 미션과 비전이 왜 중요한지 알 수 있는 경험이었습니다. 명확한 목표의식을 바탕으로 개발을 진행한 덕분에 더 의욕적으로 개발을 할 수 있었고, 프로젝트에 더 큰 애정과 자부심을 가질 수 있었습니다. 그래서 중간에 갈등이 생기더라도 우리가 쓰고 싶은 서비스를 만들자는 목표의식을 바탕으로 풀어낙나 덕분에 발전적인 방향으로 해결할 수 있었다고 생각합니다.


## 차후 계획


우리 팀은 이번 프로젝트를 단발성 프로젝트로 끝내지 않고 계속 서비스를 유지·보수·개선해나갈 생각입니다. 이 과정에서 사용자들의 피드백을 받고 서비스 운영 경험을 획득해나가는 것이 목표입니다. 

1. 현재 보고되고 있는 버그들을 수정하고 이 과정을 공지사항을 통해 공유할 생각입니다.
2. 초기화면이 로그인 화면이라 거부감을 느끼는 사용자들이 있어서 소개페이지를 만들어 메인화면으로 사용할 생각입니다.
3. 티스토리, 깃허브 뿐만아니라 다른 플랫폼으로도 확장시켜나갈 생각입니다.
